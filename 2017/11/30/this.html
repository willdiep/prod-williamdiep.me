<!DOCTYPE html><html lang=en><head><title>William Diep</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,user-scalable=no"><link rel=apple-touch-icon sizes=180x180 href=/assets/images/favicons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/assets/images/favicons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/assets/images/favicons/favicon-16x16.png><link rel=manifest href=/manifest.json><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><meta name=theme-color content=#ffffff><!--[if lte IE 8]><script src="/assets/js/ie/html5shiv.js"></script><![endif]--><link href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css rel=stylesheet><link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,300italic,600,600italic" rel=stylesheet><link rel=stylesheet href=/assets/stylesheets/style-ff864cb800.min.css><!--[if lte IE 9]><link rel="stylesheet" href="/assets/css/ie9.css" /><![endif]--><!--[if lte IE 8]><link rel="stylesheet" href="/assets/css/ie8.css" /><![endif]--></head><body><div id=wrapper><header id=header><a href=/ class=logo><strong>William Diep</strong> <span></span></a><nav><a href=#menu>Menu</a></nav></header><nav id=menu><ul class=links><li><a href=/ >Home</a></li><li><a href=projects.html>Projects</a></li><li><a href=about.html>About</a></li><li><a href=blog.html>Blog</a></li><li><a href=assets/williamdiepresume.pdf>Resume</a></li><li><a href=index.html#contact>Contact</a></li></ul><ul class="actions vertical"></ul><ul class=icons><li><a href=https://github.com/willdiep class="icon alt fa-github" target=_blank><span class=label>GitHub</span></a></li><li><a href=https://www.linkedin.com/in/wdiep class="icon alt fa-linkedin" target=_blank><span class=label>LinkedIn</span></a></li></ul></nav><div id=main class=alt><section id=one><div class=inner><header class=major><h1>What is 'this' in JavaScript?</h1></header><p></p><h3 id=are-you-confused-by-the-this-keyword-in-javascript-it-confuses-everyone-in-the-beginning-so-dont-worry-about-it-youre-not-alone>Are you confused by the <code>this</code> keyword in JavaScript? It confuses everyone in the beginning, so don’t worry about it. You’re not alone.</h3><p>But that doesn’t mean you can go on without understanding <code>this</code> forever. It is used so much in JavaScript and in tutorials everywhere that you need to grasp what <code>this</code> is sooner or later. Once you understand <code>this</code>, you’ll realize that it’s much simpler than you think it is.</p><p>By the end of this article, you would have demystified this for yourself. You’ll know what it is, what it does and how to use it.</p><h2 id=so-what-is-this>So, what is this?</h2><p>this is a keyword whose value changes depending on how a function gets called. There six different ways where this can take on new values. They are:</p><ol><li><code>this</code> in global context</li><li><code>this</code> in object construction</li><li><code>this</code> in an object method</li><li><code>this</code> in a simple function</li><li><code>this</code> in an arrow function</li><li><code>this</code> in an event listener</li></ol><p>You may wonder what <code>this</code> is in each context and why there’s a need to change <code>this</code> in the first place. To answer your question, let look at how <code>this</code> changes in each of the six contexts.</p><h3 id=this-in-a-global-context>This in a global context</h3><p>When <code>this</code> is called outside of any function, in a global context, this defaults to the <code>Window</code> object in the browser.</p><div class=highlighter-rouge><div class=highlight><pre class=highlight><code>console.log(this) // Window
</code></pre></div></div><p>Usually, you wouldn’t use <code>this</code> in a global context anyway, so the value of <code>this</code> here doesn’t really matter. Let’s move on to the next context.</p><h3 id=this-in-object-construction>This in object construction</h3><p>When you create a new instance of an object with the new keyword, this refers to the instance.</p><div class=highlighter-rouge><div class=highlight><pre class=highlight><code>function Human (age) {
  this.age = age
}

let greg = new Human(22)
let thomas = new Human(24)

console.log(greg) // this.age = 22
console.log(thomas) // this.age = 24
</code></pre></div></div><p>You can see that <code>greg</code> is an instance of <code>Human</code> in the code above. Now, whenever you reference <code>greg</code>, you won’t accidentally get <code>thomas</code>. So, setting <code>this</code> to be the instance makes perfect sense.</p><p>Let’s look at a closely related context next – <code>this</code> in an object method.</p><h3 id=this-in-an-object-method>This in an object method</h3><p>Methods are fancy words for functions that are associated with an object, like this:</p><div class=highlighter-rouge><div class=highlight><pre class=highlight><code>let o = {
  // A method
  aMethod () {}
}
</code></pre></div></div><p><code>this</code> within any method refers to the object itself.</p><div class=highlighter-rouge><div class=highlight><pre class=highlight><code>let o = {
  sayThis () {
    console.log(this)
  }
}

o.sayThis() // o
</code></pre></div></div><p>Since <code>this</code> refers to the object, you can use methods to get the instance of an object, like this:</p><div class=highlighter-rouge><div class=highlight><pre class=highlight><code>function Human (name) {
  return {
    name,
    getName() {
      return this.name
    }
  }
}

const will = new Human('Will')
const sarah = new Human('Sarah')

console.log(will.getName()) // Will
</code></pre></div></div><p>In these two object contexts, you can see that the changed value of <code>this</code> lets you get the right instance, which is the basis for Object-oriented programming. That’s a topic for another day though.</p><p>Let’s move on to the next context.</p><h3 id=this-in-a-simple-function>This in a simple function</h3><p>Simple functions are functions you know extremely well; like the one below. Anonymous functions written in the same form are also considered simple functions.</p><div class=highlighter-rouge><div class=highlight><pre class=highlight><code>function hello () {
  // say hello!
}
</code></pre></div></div><p>On browsers, <code>this</code> is always set to <code>Window</code> in a simple function. The same is true even if you call a simple function in an object method.</p><div class=highlighter-rouge><div class=highlight><pre class=highlight><code>function simpleFunction () {
  console.log(this)
}

const o = {
  sayThis () {
    simpleFunction()
  }
}

simpleFunction() // Window
o.sayThis() // Window
</code></pre></div></div><p>Unfortunately, the change in <code>this&lt;c/ode&gt; is unexpected for beginners. They expect <code>this</code> to remain the same within object methods. I got caught in it too.</code></p><p>To see why, consider the following code. Here, a <code>this.speakLeet</code> function is executed later within a <code>setTimeout</code> function.</p><div class=highlighter-rouge><div class=highlight><pre class=highlight><code>const o = {
  doSomethingLater () {
    setTimeout(function() {
      this.speakLeet() // Error
    }, 1000)
  },
  speakLeet() {
    console.log(`1337 15 4W350M3`)
  }
}
</code></pre></div></div><p>Unfortunately, the code above results in an error. The error occurs because <code>this</code> is set to <code>Window</code> in the <code>setTimeout</code> function. <code>Window</code> does not have a <code>speakLeet</code> method.</p><p>One quick fix is to create a variable that stores the reference to the <code>this&lt;/code. This variable is often called <code>self&lt;/code or <code>that&lt;/code.</code></code></code></p><div class=highlighter-rouge><div class=highlight><pre class=highlight><code>const o = {
  doSomethingLater () {
    const self = this
    setTimeout(function() {
      self.speakLeet()
    }, 1000)
  },
  speakLeet() {
    console.log(`1337 15 4W350M3`)
  }
}
</code></pre></div></div><p>A second way to fix this problem is to use the new ES6 arrow functions, which brings us to the next context.</p><h3 id=this-in-arrow-functions>This in arrow functions</h3><p><code>this</code> in an arrow function is always the same as <code>this</code> around it (in its immediate scope). So, if you use arrow functions within an object method, the <code>this</code> context stays as the object, not <code>Window</code>.</p><p>With arrow functions, the <code>speakLeet</code> example could be written in the following way:</p><div class=highlighter-rouge><div class=highlight><pre class=highlight><code>const o = {
  doSomethingLater () {
    setTimeout(() =&gt; this.speakLeet(), 1000)
  },
  speakLeet() {
    console.log(`1337 15 4W350M3`)
  }
}
</code></pre></div></div><p>A third way to change the value of <code>this</code> within any function is to use either <code>bind</code>, <code>call</code> or <code>apply</code>. We’ll look at <code>bind</code> later in the article, and <code>call</code> and <code>apply</code> another time. But first, let’s go through the final context — event listeners.</p><h3 id=this-in-event-listeners>This in event listeners</h3><p><code>this</code> is set to the element that fired the event in an event listener:</p><div class=highlighter-rouge><div class=highlight><pre class=highlight><code>let button = document.querySelector('button')

button.addEventListener('click', function() {
  console.log(this) // button
})
</code></pre></div></div><p>When creating more complex components, you may find yourself creating event listeners within methods.</p><div class=highlighter-rouge><div class=highlight><pre class=highlight><code>function LeetSpeaker (elem) {
  return {
    listenClick () {
      elem.addEventListener('click', function () {
        // Do something here
      })
    }
  }
}
</code></pre></div></div><p>Since <code>this</code> refers to the element in the event listener, if you need to activate another method, you need to provide a reference to the object with.</p><div class=highlighter-rouge><div class=highlight><pre class=highlight><code>function LeetSpeaker (elem) {
  return {
    listenClick () {
      const self = this
      elem.addEventListener('click', function () {
        self.speakLeet()
      })
    },
    speakLeet() { console.log(`1337 15 4W350M3`) }
  }
}
</code></pre></div></div><p>Alternatively, you can use an arrow function. If you do so, you can still get the element with <code>event.currentTarget</code>.</p><div class=highlighter-rouge><div class=highlight><pre class=highlight><code>function LeetSpeaker (elem) {
  return {
    listenClick () {
      elem.addEventListener('click', (e) =&gt; {
        console.log(e.currentTarget) // elem
        this.speakLeet()
      })
    },
    speakLeet() { console.log(`1337 15 4W350M3`) }
  }
}
</code></pre></div></div><p>But both methods aren’t good enough to help you remove event listeners when the need arises, both are anonymous functions.</p><p>To remove an event listener, the callback passed as the second value needs to be a named function:</p><div class=highlighter-rouge><div class=highlight><pre class=highlight><code>function someFunction () {
  console.log('do something')

  // Removes the event listener.
  document.removeEventListener('click', someFunction)
}

document.addEventListener('click', someFunction)
</code></pre></div></div><p>If you need <code>this</code> to reference the object in an event listener, you need to use <code>bind</code> to manually create a <code>this</code> context.</p><div class=highlighter-rouge><div class=highlight><pre class=highlight><code>function LeetSpeaker (elem) {
  return {
    listenClick () {
      this.listener = this.speakLeet.bind(this)
      elem.addEventListener('click', this.listener)
    },

    speakLeet(e) {
      const elem = e.currentTarget
      console.log(`1337 15 4W350M3`)
      elem.removeEventListener('click', this.listener)
    }
  }
}
</code></pre></div></div><p>The code above may confuse you if you’ve don’t understand <code>bind</code>. So, before I show you what is happening, let’s take a detour and understand what <code>bind</code> does.</p><h3 id=changing-this-with-bind>Changing this with bind</h3><p><code>bind</code> is a method that is present in every function. It allows you to change the <code>this</code> context. This method takes in any number of arguments and returns the bound function.</p><div class=highlighter-rouge><div class=highlight><pre class=highlight><code>function sayThis () {
  console.log(this)
}
const boundFunc = sayThis.bind(/* arguments...*/)
</code></pre></div></div><p>The first parameter you pass into <code>bind</code> becomes <code>this</code> in the bound function. Once you have created a bound function, you can call it anytime you wish:</p><div class=highlighter-rouge><div class=highlight><pre class=highlight><code>function sayThis () {
  console.log(this)
}

const boundFunc = sayThis.bind({hippy: 'hipster'})
boundFunc()
</code></pre></div></div><p>The other parameters you pass to <code>bind</code> will be passed as arguments to the original function</p><div class=highlighter-rouge><div class=highlight><pre class=highlight><code>function sayParams (...args) {
  console.log(...args)
}
const boundFunc = sayParams.bind(null, 1, 2, 3, 4, 5)
boundFunc()
</code></pre></div></div><p>Note: <code>bind doesn’t work with arrow functions.</code></p><p>That’s really all you need to know about <code>bind</code>.</p><p>Now, let’s look back at the code to remove event listeners and dissect what is happening:</p><div class=highlighter-rouge><div class=highlight><pre class=highlight><code>function LeetSpeaker (elem) {
  return {
    listenClick () {
      // Binds this.speakLeet with a reference to the instance.
      // Sets bound function to this.listener, so we can remove it later.
      this.listener = this.speakLeet.bind(this)
      elem.addEventListener('click', this.listener)
    },

    speakLeet(e) {
      console.log(`1337 15 4W350M3`)

      // Gets the element so we can remove the event listener.
      const elem = e.currentTarget

      // Removes the event listener.
      elem.removeEventListener('click', this.listener)
    }
  }
}
</code></pre></div></div><p>And that’s all you need to know about <code>this</code>.</p><p>Let’s wrap up.</p><h2 id=wrapping-up>Wrapping up</h2><p><code>this</code> is a crucial keyword in JavaScript. It appears in many JavaScript frameworks, so you have to know what it does.</p><p>In this article, you learned about the six different contexts where <code>this</code> takes on different values. You also learned how to change the <code>this</code> context with functions like <code>bind</code>. Additionally, you also learned to remove event listeners properly.</p><p>That’s all you need to know about this. Just master the concepts taught in this article and you won’t ever get confused anymore.</p><p></p></div></section></div><section id=newsletter class=desaturate><div class=inner><div class=12u><h2 style="text-align: center">Subscribe for Weekly Blog</h2><p style="text-align: center">Sign up to receive articles learning about web development, JavaScript fundamentals, data stuctures and algorithms, and much more!</p><form style="text-align: center; margin: 0" action="https://williamdiep.us17.list-manage.com/subscribe/post?u=b37a4507c40405ff08a12ae50&amp;id=1ed4dd3cf5" id=subscribe-form method=post novalidate><div><input type=email class="form-control input-subscribe" id=mce-EMAIL name=EMAIL placeholder="Enter email address" required><label for=mce-EMAIL></label></div><br><button type=submit class=btn>Subscribe</button><br><br><p style="text-align: center; font-size: 0.7em">You can unsubscribe at any time</p></form></div></div></section><section><a href=# id=return-to-top><i class="fa fa-chevron-up" aria-hidden=true></i></a></section><section id=contact><div class=inner><section><header class=major><h2>Contact</h2></header><h3>Are you looking for a professional, communicative &amp; punctual software developer with full-stack web development skills for your next project?</h3><p>If you have an application you are interested in developing with web technology, I’d love to work with you on it. I’m a full-stack developer which means I can bring your project from concept to completion. Although I've been work primarily with ReactJS on the front-end, and Rails and NodeJS on the back-end, picking up new languages or frameworks is not a problem.</p><form action=https://formspree.io/willwebdesigns@gmail.com method=POST><div class="field half first"><label for=name>Name</label><input type=email name=name id=name></div><div class="field half"><label for=email>Email</label><input type=email name=_replyto id=email></div><div class=field><label for=message>Message</label><textarea name=message id=message rows=6 placeholder="Hey William! I would like to drop a note to say..."></textarea></div><ul class=actions><li><input type=submit value="Send Message" class=special></li><li><input type=reset value=Clear></li></ul></form></section></div></section><footer id=footer><div class=inner><ul class=icons><li><a href=https://github.com/willdiep class="icon alt fa-github" target=_blank><span class=label>GitHub</span></a></li><li><a href=https://www.linkedin.com/in/wdiep class="icon alt fa-linkedin" target=_blank><span class=label>LinkedIn</span></a></li></ul><ul class=copyright><li>&copy; 2017 William Diep All Rights Reserved</li></ul></div></footer></div><script src=/assets/javascript/index-6ef757b174.min.js></script></body></html>